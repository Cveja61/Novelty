/*    Randomise_Point_Coordinates.jsx    Version 1.0    Bruno Herfst 2014    This script randomises the coordinates of all points of a given object	// ToDo: Option to add path points via interpolation*/#target InDesignvar maxmovement = 1.5; // movement in current measure unit//Make certain that user interaction (display of dialogs, etc.) is turned on.app.scriptPreferences.userInteractionLevel = UserInteractionLevels.interactWithAll;//Check if we have what we need to run the script.if (app.documents.length == 0){	alert("Open a document before running this script.");	exit();} else if (app.selection.length == 0){	alert("Select an object before running this script");	exit();}var myPathList = new Array;for(var i = 0;i < app.selection.length; i++){	switch (app.selection[i].constructor.name){		case "Rectangle":		case "TextFrame":		case "Oval":		case "Polygon":		case "GraphicLine":		case "Group":		case "PageItem":		myPathList.push(app.selection[i]);		break;	}}if (myPathList.length == 0){	alert ("Select a rectangle or text frame and try again.");	exit;}randomisePathPoints(myPathList);function randomisePathPoints(myPathList){	for(var obj = 0;obj < myPathList.length; obj++){		for(var path = 0;path < myPathList[obj].paths.length; path++){			//var newPath = new Array;			for(var point = 0;point < myPathList[obj].paths[path].pathPoints.length; point++){				var current_X = myPathList[obj].paths[path].pathPoints[point].anchor[0];				var current_Y = myPathList[obj].paths[path].pathPoints[point].anchor[1];				var min_X = current_X - maxmovement;				var max_X = current_X + maxmovement;				var min_Y = current_Y - maxmovement;				var max_Y = current_Y + maxmovement;				myPathList[obj].paths[path].pathPoints[point].anchor = [randomInRange(min_X,max_X), randomInRange(min_Y,max_Y)];			}		}	}}function randomInRange(start,end){	return Math.random() * (end - start) + start;}